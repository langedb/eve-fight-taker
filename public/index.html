<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVE Fight Taker - Combat Analysis Tool</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <h1><i class="fas fa-rocket"></i> EVE Fight Taker</h1>
            <nav class="nav">
                <div id="auth-section">
                    <button id="login-btn" class="btn btn-primary">
                        <i class="fas fa-sign-in-alt"></i> Login with EVE SSO
                    </button>
                    <div id="user-info" class="user-info" style="display: none;">
                        <span id="character-name"></span>
                        <button id="logout-btn" class="btn btn-secondary">Logout</button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <section class="intro">
                <h2>Ship Combat Analysis</h2>
                <p>Analyze your ship's combat effectiveness against enemy fits using AI-powered tactical recommendations.</p>
            </section>

            <div class="analysis-grid">
                <div class="card">
                    <h3><i class="fas fa-ship"></i> Your Ship</h3>
                    <div id="your-ship-section">
                        <textarea id="your-eft-input" placeholder="Paste your EFT fit or zKillboard URL here...

EFT Example:
[Ishtar, Your Ishtar Fit]
Medium Remote Capacitor Transmitter II
...

zKillboard Example:
https://zkillboard.com/kill/123456789/

Right-click your ship in-game → Copy → Copy Fitting" rows="15" class="eft-textarea"></textarea>
                        <button id="parse-your-eft" class="btn btn-primary">
                            <i class="fas fa-upload"></i> Load Your Fit
                        </button>
                        <button id="load-fittings-btn" class="btn btn-secondary">
                            <i class="fas fa-download"></i> Load Stored Fittings
                        </button>
                        <div id="your-ship-info" class="ship-info" style="display: none;">
                            <h4 id="your-ship-name"></h4>
                            <div id="your-ship-stats" class="stats-grid"></div>
                        </div>
                        <div id="fittings-list-container" style="display: none;">
                            <h4>Stored Fittings:</h4>
                            <div class="advanced-dropdown-container">
                                <div class="search-input-container">
                                    <input type="text" id="fittings-search" class="search-input" placeholder="Type to search fittings..." autocomplete="off">
                                    <i class="fas fa-search search-icon"></i>
                                    <i class="fas fa-chevron-down dropdown-arrow" id="dropdown-arrow"></i>
                                </div>
                                <div class="dropdown-list" id="fittings-dropdown-list" style="display: none;">
                                    <div class="dropdown-content" id="fittings-dropdown-content">
                                        <!-- Grouped options will be populated here -->
                                    </div>
                                </div>
                            </div>
                            <button id="load-selected-fitting-btn" class="btn btn-primary mt-2" disabled>Load Selected Fitting</button>
                        </div>
                    </div>
                </div>

                <div class="swap-container">
                    <button id="swap-fits-btn" class="btn btn-swap" title="Swap Your Ship ↔ Target Ship">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                </div>

                <div class="card">
                    <h3><i class="fas fa-crosshairs"></i> Target Ship</h3>
                    <div id="target-ship-section">
                        <!-- Death Analysis Section -->
                        <div class="death-analysis-section">
                            <h4><i class="fas fa-skull"></i> Death Analysis</h4>
                            <p>Load a character's most recent death in a specific ship type from zKillboard:</p>
                            <div class="feature-notice">
                                <i class="fas fa-info-circle"></i>
                                <span>This feature requires the character to have recent PvP activity. For best results, use characters with recent killmails.</span>
                            </div>
                            
                            <div class="death-analysis-inputs">
                                <div class="input-group">
                                    <label for="character-name-input">Character Name:</label>
                                    <input type="text" id="character-name-input" placeholder="Enter character name..." class="character-input">
                                </div>
                                
                                <div class="input-group">
                                    <label for="ship-type-search">Ship Type:</label>
                                    <div class="ship-type-dropdown-container">
                                        <div class="search-input-container">
                                            <input type="text" id="ship-type-search" class="search-input" placeholder="Type to search ship types..." autocomplete="off">
                                            <i class="fas fa-search search-icon"></i>
                                            <i class="fas fa-chevron-down dropdown-arrow" id="ship-dropdown-arrow"></i>
                                        </div>
                                        <div class="dropdown-list" id="ship-type-dropdown-list" style="display: none;">
                                            <div class="dropdown-content" id="ship-type-dropdown-content">
                                                <!-- Ship type options will be populated here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <button id="load-death-fit-btn" class="btn btn-warning" disabled>
                                    <i class="fas fa-download"></i> Load Death Fit
                                </button>
                            </div>
                            
                            <div class="or-divider">
                                <span>OR</span>
                            </div>
                        </div>

                        <!-- Manual Fit Input Section -->
                        <div class="manual-fit-section">
                            <h4><i class="fas fa-edit"></i> Manual Fit Input</h4>
                            <textarea id="eft-input" placeholder="Paste EFT fit or zKillboard URL here...

EFT Example:
[Rifter, PvP Fit]
200mm AutoCannon II, Republic Fleet EMP S
200mm AutoCannon II, Republic Fleet EMP S
[Empty High slot]
...

zKillboard Example:
https://zkillboard.com/kill/123456789/

Hobgoblin II x5" rows="12" class="eft-textarea"></textarea>
                            <button id="parse-eft" class="btn btn-primary">
                                <i class="fas fa-cog"></i> Parse Fit
                            </button>
                        </div>

                        <div id="target-ship-info" class="ship-info" style="display: none;">
                            <h4 id="target-ship-name"></h4>
                            <div id="target-ship-stats" class="stats-grid"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="analysis-section" id="analysis-section" style="display: none;">
                <div class="card">
                    <h3><i class="fas fa-brain"></i> AI Combat Analysis</h3>
                    <button id="analyze-combat" class="btn btn-success btn-large">
                        <i class="fas fa-chart-line"></i> Analyze Combat
                    </button>
                    <div id="analysis-results" style="display: none;">
                        <div class="analysis-header">
                            <div class="win-chance">
                                <h4>Win Chance</h4>
                                <div class="win-percentage" id="win-percentage">0%</div>
                            </div>
                            <div class="time-to-kill">
                                <h4>Est. Time to Kill</h4>
                                <div class="ttk-value" id="ttk-value">N/A</div>
                            </div>
                        </div>
                        
                        <div class="analysis-details">
                            <div class="advantages">
                                <h4><i class="fas fa-plus-circle"></i> Your Advantages</h4>
                                <ul id="advantages-list"></ul>
                            </div>
                            <div class="disadvantages">
                                <h4><i class="fas fa-minus-circle"></i> Your Disadvantages</h4>
                                <ul id="disadvantages-list"></ul>
                            </div>
                        </div>

                        <div class="recommendations-section">
                            <div class="ammo-recommendations">
                                <h4><i class="fas fa-bullseye"></i> Ammo Recommendations</h4>
                                <ul id="ammo-recommendations-list"></ul>
                            </div>
                            <div class="module-recommendations">
                                <h4><i class="fas fa-cogs"></i> Module Usage</h4>
                                <ul id="module-recommendations-list"></ul>
                            </div>
                        </div>

                        <div class="tactics-section">
                            <h4><i class="fas fa-chess"></i> Tactical Recommendations</h4>
                            <div class="tactics-grid">
                                <div class="tactic">
                                    <h5>Range</h5>
                                    <p id="tactic-range"></p>
                                </div>
                                <div class="tactic">
                                    <h5>Movement</h5>
                                    <p id="tactic-movement"></p>
                                </div>
                                <div class="tactic">
                                    <h5>Engagement</h5>
                                    <p id="tactic-engagement"></p>
                                </div>
                                <div class="tactic">
                                    <h5>Disengagement</h5>
                                    <p id="tactic-disengagement"></p>
                                </div>
                            </div>
                        </div>

                        <div class="summary-section">
                            <h4><i class="fas fa-lightbulb"></i> Summary</h4>
                            <p id="analysis-summary"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 EVE Fight Taker. EVE Online and all related materials are property of CCP Games.</p>
        </div>
    </footer>

    <div id="loading" class="loading" style="display: none;">
        <div class="loading-content">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Analyzing combat scenario...</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>